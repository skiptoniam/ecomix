<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>This is how you fit a species archetype model (SAM) in ecomix. — species_mix • ecomix</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="This is how you fit a species archetype model (SAM) in ecomix. — species_mix" />
<meta property="og:description" content="Fits a mixture-of-regressions (SAM) to identify species archetypes." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecomix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/RCP-example.html">Region of Common Profiles Example</a>
    </li>
    <li>
      <a href="../articles/SAM-example.html">Species Archetype Model Example</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/skiptoniam/ecomix/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>This is how you fit a species archetype model (SAM) in ecomix.</h1>
    <small class="dont-index">Source: <a href='https://github.com/skiptoniam/ecomix/blob/master/R/species_mix-class.R'><code>R/species_mix-class.R</code></a></small>
    <div class="hidden name"><code>species_mix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a mixture-of-regressions (SAM) to identify species archetypes.</p>
    </div>

    <pre class="usage"><span class='fu'>species_mix</span><span class='op'>(</span>
  archetype_formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  species_formula <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>as.formula</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>1</span><span class='op'>)</span>,
  all_formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>data</span>,
  nArchetypes <span class='op'>=</span> <span class='fl'>3</span>,
  family <span class='op'>=</span> <span class='st'>"bernoulli"</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  bb_weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  size <span class='op'>=</span> <span class='cn'>NULL</span>,
  power <span class='op'>=</span> <span class='fl'>1.6</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  inits <span class='op'>=</span> <span class='cn'>NULL</span>,
  titbits <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>archetype_formula</th>
      <td><p>an object of class "formula" (or an object that can
be coerced to that class). The response variable (left hand side of the
formula) needs to be either 'occurrence', 'abundance',
'biomass' or 'quantity' data. The type of response data will help specify
the type of error distribution to be used. The dependent variables
(the right hind side) of this formula specifies the dependence of the
species archetype probabilities on covariates. For all model the basic
formula structure follows something like this:
cbind(spp1,spp2,spp3)~1+temperature+rainfall</p></td>
    </tr>
    <tr>
      <th>species_formula</th>
      <td><p>an object of class "formula" (or an object that can be
coerced to that class). The right hand side of this formula specifies the
dependence of the species"'" data on covariates (typically different
covariates to <code>archetype_formula</code> to avoid confusing confounding).
Current the formula is set at ~ 1 by default for species-specific intercepts
for the archetype models. If you include a species specific formula which has
more than an intercept you will be fitting a partial species archetype model
which has species specific covariates and archetype specific covariates.</p></td>
    </tr>
    <tr>
      <th>all_formula</th>
      <td><p>an object of class "formula", which is meant to represent
a constant single set of covariates across all species and groups, typically
you might use this an alternative to an offset, where there might be a set
covariates which means artifact of how the data was collected or some other
process like a seasonality.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a matrix or data.frame which contains the 'species_data'
matrix, a const and the covariates in the structure of spp1, spp2, spp3,
const, temperature, rainfall. dims of matrix should be
nsites*(nspecies+const+covariates).</p></td>
    </tr>
    <tr>
      <th>nArchetypes</th>
      <td><p>The number of archetypes (mixing components/groups) to
estimate from the data. This need to be explicitly declared. By default it is
set to 3.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>The family of statistical family to use within
the ecomix models. family can be a function from <a href='https://rdrr.io/r/stats/family.html'>family</a>, such as
binomial(). OR it can be a choice between "bernoulli", "binomial", "poisson",
"negative.binomial", "tweedie" and "gaussian" families. An error will be
thrown if the family is not recognized. The family you use is generally
specific to the type of data you have. One can also specify a link function
such as "cloglog" via binomial(link="cloglog"). If you wish to fit a point
process version of a SAM please refer to the ecomix.ppm package.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>a numeric vector of length nrow(data) (n sites) that is
included into the model as an offset. It is included into the conditional
part of the model where conditioning is performed on the SAM.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>a numeric vector of length ncol(Y) (n species) that is used
as weights in the log-likelihood calculations. If NULL (default) then all
weights are assumed to be identically 1. Because we are estimating the
log-likelihood over species (rather than sites), the weights should be a
vector n species long.</p></td>
    </tr>
    <tr>
      <th>bb_weights</th>
      <td><p>a numeric vector of n species long. This is used for
undertaking a Bayesian Bootstrap. See 'vcov.species_mix' for more details.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>The size of the sample for a binomial model (defaults to 1).</p></td>
    </tr>
    <tr>
      <th>power</th>
      <td><p>The power parameter for 'tweedie' family. Default is 1.6, and
this is assigned to all species</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of control parameters for optimization and calculation.
See details.</p></td>
    </tr>
    <tr>
      <th>inits</th>
      <td><p>NULL a numeric vector that provides approximate starting values
for species_mix coefficients. These are family specific, but at a
minimum you will need pi (additive_logistic transformed), alpha
(intercepts) and beta (mixing coefs).</p></td>
    </tr>
    <tr>
      <th>titbits</th>
      <td><p>either a boolean or a vector of characters. If TRUE
(default for species_mix(qv)), then some objects used in the estimation of
the model"'"s parameters are returned in a list entitled "titbits" in the
model object. Some functions, for example plot.species_mix(qv) and
predict.species_mix(qv), will require some or all of these pieces of
information. If titbits=FALSE (default for species_mix.multifit(qv)),
then an empty list is returned. If a character vector, then just those
objects are returned. Possible values are:"Y" for the outcome matrix, "X"
for the model matrix for the SAM model, "offset" for the offset in the model,
"site_spp_weights" for the model weights, "archetype_formula" for the formula
for the SAMs, "species_formula" for the formula for the species-specific
model, "control" for the control arguments used in model fitting, "family" for
the conditional distribution of the species data. Care needs to be taken when
using titbits=TRUE in species_mix.multifit(qv) calls as titbits is created
for EACH OF THE MODEL FITS. If the data is large or if nstart is large, then
setting titbits=TRUE may give users problems with memory.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>species_mix is used to fit mixtures of glms to multivariate
species data. The function uses BFGS to optimize the mixture likelihood.
There is the option to use ECM algorithm to get appropriate starting
parameters. `species_mix` acts as a wrapper for species_mix.fit
that allows for easier data input. The data frames are merged into
the appropriate format for the use in species_mix.fit.
Minima is found using vmmin (BFGS). Currently 'bernoulli', 'binomial',
'poisson', 'negative.binomial' and 'gaussian' distributions can be fitted
using the species_mix function. For Point Process extensions of SAMs please
refer to the ecomix.ppm package.</p>
<p>species_mix is used to fit mixtures of glms to multivariate
species data. The function uses BFGS to optimize the mixture likelihood.
There is the option to use ECM algorithm to get appropriate starting
parameters. `species_mix` acts as a wrapper for species_mix.fit
that allows for easier data input. The data frames are merged into
the appropriate format for the use in species_mix.fit.
Minima is found using vmmin (BFGS).</p>
<p>Control arguments for species_mix are as follows:</p><dl>
 <dt>maxit</dt><dd><p>The maximum number of iterations. Default is 1000.</p></dd>
 <dt>quiet</dt><dd><p>Should any reporting be performed? Default is FALSE, for reporting.</p></dd>
 <dt>trace</dt><dd><p>Non-negative integer. If positive, tracing information on the progress of the optimization is produced. Higher values may produce more tracing information. If quiet=TRUE, then trace will be set to zero.</p></dd>
 <dt>init.glmnet</dt><dd><p>Use glmnet to get initial starting values, default is TRUE, if FALSE, glm2 will be used.</p></dd>
 <dt>init.method</dt><dd><p>Which initialsation approach to use for covariates, default is "random2" which is uses k-means on the groups and adds some random noise. Alternatives are 'kmeans' and 'kmed'</p></dd>
 <dt>init.sd</dt><dd><p>The amount of gaussian variation to add to starting values, default is NA, which adds variantion in based on the standard deviation of the parameters. Otherwise should be a double like 0.3</p></dd>
 <dt>minimum.presencess</dt><dd><p>The number of presences required for each species to be included when generaling the starting values, the default is to remove all species &lt;= 30 occurrences during inititalisation, these species will still be included in the model fit.</p></dd>
 <dt>ecm.prefit</dt><dd><p>Use ECM to generate starting values? If FALSE, the model will use starting values without the ECM.</p></dd>
 <dt>ecm.refits</dt><dd><p>The number of ECM refits to run, the default is 2, users could increase this to potentially get better starting values.</p></dd>
 <dt>ecm.steps</dt><dd><p>The numer of ECM steps/iterations to run per ECM fit, the default is 5.</p></dd>
 <dt>ecm.reltol</dt><dd><p>The relative tolerance for the ECM, default is quiet large 1e-2, makin this smaller will make the convergance tolerance stickter, you'll have to also adjust the "ecm.steps", to be larger if you make this stickter.</p></dd>
 <dt>print.cpp.inits</dt><dd><p>Print the intialisation values being passed to c++. Handy for debugging especially if 'vmmin' error call</p></dd>
 <dt>nreport</dt><dd><p>The frequency of reports for optimisation. Default is 10 a report for 10th iteration.</p></dd>
 <dt>abstol</dt><dd><p>The abstol for vmmin, the default is -Inf. See <a href='https://rdrr.io/r/stats/optim.html'>optim</a> for further details</p></dd>
 <dt>reltol</dt><dd><p>Relative convergence tolerance. The algorithm stops if it is unable to reduce the value by a factor of reltol * (abs(val) + reltol) at a step. Defaults to sqrt(.Machine$double.eps), typically about 1e-8.</p></dd>
 <dt>optimise.cpp</dt><dd><p>Should optimisation for estimation occur? If TRUE (default) optimisation will occur. If FALSE no optimisation is performed.</p></dd>
 <dt>getscores.cpp</dt><dd><p>Should we return the scores (derivates) when doing optimsation? If FALSE (default) scores will not be returned. If TRUE scores will be returned.</p></dd>
 <dt>loglOnly.cpp</dt><dd><p>Should the log-likelihood be caulcated? If TRUE (default) then log-likelihood is calculated and returned. If FALSE then the log-likelihood is not calculated for return.</p></dd>
 <dt>derivOnly.cpp</dt><dd><p>Should the scores be evaluated at the (final) parameter values. If TRUE (default) then they are calculated. If FALSE then they are not calculated.</p></dd>
 <dt>doPenalties</dt><dd><p>A boolean 0 or 1. Default is 0 (false) and no penalities will be applied within the optimsation.</p></dd>
 <dt>penalty.pi</dt><dd><p>A numeric scalar. This is the penalty for the mixing coefs. The penality is an from a Dirichlet distribution.</p></dd>
 <dt>penalty.alpha</dt><dd><p>A numeric scalar. This is the penalty for the alpha parameters in the species model. They are assumed to come from a normal distribution with standard deviation given as this parameter (default is 10).</p></dd>
 <dt>penalty.beta</dt><dd><p>A numeric scalar. This is the penalty for the beta parameters in the  group model. They are assumed to come from a normal distribution with standard deviation given as this parameter (default is 10).</p></dd>
 <dt>penalty.gamma</dt><dd><p>A numeric scalar. This is the penalty for the gamma parameters in the species model. They are assumed to come from a normal distribution with standard deviation given as this parameter (default is 10).</p></dd>
 <dt>penalty.delta</dt><dd><p>A numeric scalar. This is the penalty for the delta parameters in the bias model. They are assumed to come from a normal distribution with standard deviation given as this parameter (default is 10).</p></dd>
 
</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/skiptoniam/ecomix'>ecomix</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>42</span><span class='op'>)</span>
<span class='va'>sam_form</span> <span class='op'>&lt;-</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>as.formula</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'cbind('</span>,<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'spp'</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span><span class='op'>)</span>,
collapse <span class='op'>=</span> <span class='st'>','</span><span class='op'>)</span>,<span class='st'>")~x1+x2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sp_form</span> <span class='op'>&lt;-</span> <span class='op'>~</span> <span class='fl'>1</span>
<span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.9</span>,<span class='op'>-</span><span class='fl'>3.6</span>,<span class='op'>-</span><span class='fl'>0.9</span>,<span class='fl'>1</span>,<span class='fl'>.9</span>,<span class='fl'>1.9</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>100</span><span class='op'>)</span>,x1<span class='op'>=</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>2.5</span><span class='op'>)</span>,
x2<span class='op'>=</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>2.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>simulated_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='species_mix.simulate.html'>species_mix.simulate</a></span><span class='op'>(</span>archetype_formula <span class='op'>=</span> <span class='va'>sam_form</span>,species_formula <span class='op'>=</span> <span class='va'>sp_form</span>,
data <span class='op'>=</span> <span class='va'>dat</span>,beta<span class='op'>=</span><span class='va'>beta</span>,family<span class='op'>=</span><span class='st'>"bernoulli"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Random alpha from normal (-1,0.5) distribution</span></div><div class='input'><span class='va'>fm1</span> <span class='op'>&lt;-</span> <span class='fu'>species_mix</span><span class='op'>(</span>archetype_formula <span class='op'>=</span> <span class='va'>sam_form</span>,species_formula <span class='op'>=</span> <span class='va'>sp_form</span>,
data <span class='op'>=</span> <span class='va'>simulated_data</span>, family <span class='op'>=</span> <span class='st'>'bernoulli'</span>,  nArchetypes<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>SAM modelling</span></div><div class='output co'>#&gt; <span class='message'>There are 3 archetypes</span></div><div class='output co'>#&gt; <span class='message'>There are 100 site observations for 20 species</span></div><div class='output co'>#&gt; <span class='message'>The model for the archetype (grouping) is ~x1 + x2</span></div><div class='output co'>#&gt; <span class='message'>The model for the species is ~1</span></div><div class='output co'>#&gt; <span class='message'>You are implementing a bernoulli Species Archetype Model.</span></div><div class='output co'>#&gt; <span class='message'>This model uses a logit link function.</span></div><div class='output co'>#&gt; <span class='message'>Using ECM algorithm to find starting values; using 1 refits</span></div><div class='output co'>#&gt; <span class='message'>ECM restart 1 of 1</span></div><div class='output co'>#&gt; <span class='message'>Initialising starting values</span></div><div class='output co'>#&gt; <span class='message'>Initial groups parameter estimates by K-means clustering</span></div><div class='output co'>#&gt; <span class='message'>Iteration: 1 | New loglik -950.728 | Ratio loglik 0</span></div><div class='output co'>#&gt; <span class='message'>Iteration: 2 | New loglik -829.843 | Ratio loglik 0.87285</span></div><div class='output co'>#&gt; <span class='message'>Iteration: 3 | New loglik -820.246 | Ratio loglik 0.988434</span></div><div class='output co'>#&gt; <span class='message'>Iteration: 4 | New loglik -819.839 | Ratio loglik 0.999504</span></div><div class='output co'>#&gt; initial  value 819.837517 
#&gt; iter  10 value 819.706573
#&gt; final  value 819.703416 
#&gt; converged</div><div class='input'> <span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Skipton Woolley, Scott Foster, Piers Dunstan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


